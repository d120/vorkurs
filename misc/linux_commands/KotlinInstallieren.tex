% !TeX document-id = {505cbeed-ac21-4fdd-a7f4-eefb28b91c1e}
% !TeX TXS-program:compile = txs:///pdflatex/[--shell-escape]
% \documentclass[accentcolor=3c,colorbacktitle,12pt]{tudaexercise}
\RequirePackage{import}
\subimport{../../exercises}{preamble.tex}
\usepackage{hyperref}
\title{Installation von Kotlin}
\subsubtitle{vorkurs@d120.de}

\begin{document}
\maketitle


In dieser Installationsanleitung installieren wir:
\begin{itemize}
    \item Kotlin version 1.9
    \item Java Jdk 17 (wird für Kotlin benötigt)
    \item \href{https://github.com/Kotlin/kotlin-interactive-shell}{ki (\underline{K}otlin \underline{I}nteractive-Shell)}
\end{itemize}
\section*{Windows}
% \subsection*{Komanndozeile öffnen (Powershell)}
% Siehe Terminal guide
% \subsection*{Automatische Installation durch Winget}
% \begin{hinweis}
%     Winget gibt es erst ab Windows 10 2004. Wenn du eine ältere Version hast, musst du die manuelle Installation verwenden.
% \end{hinweis}
% \begin{itemize}
%     \item Als erstes musst du die JDK installieren. Ob du bereits eine JDK installiert hast, kannst du mit dem folgenden Befehl feststellen:
%         \begin{commandshell}
%             @\shellprefix{}@java -version
%         \end{commandshell}
%         Wenn die Rückgabe sowas wie \verb+java version "17.0.1"+ ist, hast du bereits eine JDK installiert. In diesem Fall kannst du die JDK-Installation überspringen. Für die aktuelle Kotlin Version wird mindestens JDK-Version 17 benötigt.
%     \item Gebe in der Powershell den folgenden Befehl ein und drücke Enter\footnote{Befehl generiert mit \url{https://winstall.app/apps/JetBrains.Kotlin.Complier}}:
%         \begin{commandshell}
%             @\shellprefix{}@winget install --id=EclipseAdoptium.Temurin.17.JDK -e
%         \end{commandshell}
%     \item Wenn verlangt wird, dass du die Nutzungsbedingungen akzeptierst, drücke \texttt{y} und Enter
%     \item Warte, bis die Installation abgeschlossen ist
%     \item Als nächstes installieren wir den Kotlin Compiler. Gebe dazu den folgenden Befehl ein und drücke Enter\footnote{Befehl generiert mit \url{https://winstall.app/apps/JetBrains.Kotlin.Complier}}:
%         \begin{commandshell}
%             @\shellprefix{}@winget install --id=JetBrains.Kotlin.Complier -e
%         \end{commandshell}
%     \item Damit die neuen Befehle erkannnt werden, musst du die Kommandozeile neu starten, also einmal schließen und wieder öffnen.
%     \item Überprüfe die Installation (siehe Abschnitt \nameref{sec:check})
% \end{itemize}
\subsection*{Automatische Installation durch Chocolatey}
\subsubsection*{Chocolatey installieren}
\begin{itemize}
    \item Falls chocolatey schon installiert ist, kannst du diesen Schritt überspringen
    \item Gebe in der Powershell den folgenden Befehl ein und drücke Enter\footnote{Befehl generiert mit \url{https://chocolatey.org/install}} (da der Befehl sich nicht gut kopieren lässt am Besten aus dem Link der Fußnote kopieren):
        \begin{commandshell}
            @\shellprefix{}@Set-ExecutionPolicy Bypass -Scope Process -Force;
            [System.Net.ServicePointManager]::SecurityProtocol =
            [System.Net.ServicePointManager]::SecurityProtocol -bor 3072;
            iex ((New-Object System.Net.WebClient)
            .DownloadString('https://community.chocolatey.org/install.ps1'))
        \end{commandshell}
    \item Warte, bis die Installation abgeschlossen ist
\end{itemize}
\begin{hinweis}
    Ab Windows 10 kann chocolatey auch über winget per \texttt{winget install chocolatey} installiert werden.
\end{hinweis}
\clearpage
\subsubsection*{JVM und Kotlin Compiler durch Chocolatey installieren}
\begin{itemize}
    \item Gebe in der Powershell den folgenden Befehl ein und drücke Enter\footnote{siehe auch \url{https://community.chocolatey.org/packages/kotlinc} und \url{https://community.chocolatey.org/packages/Temurin17/}}:
        \begin{commandshell}
            @\shellprefix{}@choco install temurin17 kotlinc -y
        \end{commandshell}
    \item Warte, bis die Installation abgeschlossen ist
    \item Damit die neuen Befehle erkannnt werden, musst du die Kommandozeile neu starten, also einmal schließen und wieder öffnen.
    \item Überprüfe die Installation (siehe Abschnitt \nameref{sec:check})
\end{itemize}
\subsubsection{ki}
Aktuell gibt es leider keinen \enquote{schönen} Weg, \texttt{ki} über einen Paketmanager zu installieren. Stattdessen kannst du \texttt{ki} lokal installieren. Dazu musst du folgende Schritte ausführen:
\begin{itemize}
    \item Lade KI von hier herunter \url{https://github.com/Kotlin/kotlin-interactive-shell/releases/tag/v0.5.2}
    \item Entpacke die Datei in einen Ordner deiner Wahl.
    \item Gehe nun in den bin-Ordner der entpackten Datei und öffne dort ein Terminal. (Siehe Terminal-Anleitung)
    \item Es kann sein, dass du statt dem Befehl \texttt{ki} den Befehl \texttt{ki.bat} ausführen musst.
    \item Überprüfe die Installation (siehe Abschnitt \nameref{sec:check})
\end{itemize}
\begin{hinweis}
    Diese Installation funktioniert nur, solange sich deine Komandozeile im bin-Ordner befindet. Wenn du die Komandozeile schließt, musst du beim nächsten öffnen erneut in den bin-Ordner wechseln.
\end{hinweis}
% \subsubsection*{ki durch Chocolatey installieren}
% \begin{itemize}
%     \item Gebe in der Powershell den folgenden Befehl ein und drücke Enter\footnote{siehe auch \url{https://community.chocolatey.org/packages/ki}}:
%         \begin{commandshell}
%             @\shellprefix{}@choco install ki -y
%         \end{commandshell}
%     \item Selbes Spiel wie oben
% \end{itemize}


% \subsection*{Manuell (nicht empfohlen!!!, nur wenn Winget und Chocolatey nicht funktionieren)}
% \subsubsection*{Download}
% \begin{itemize}
%     \item JDK 17 oder höher wird vorausgesetzt
%     \item Gehe auf die Seite \url{https://github.com/JetBrains/kotlin/releases} und lade die neuste Version herunter (die neuste Version ist die oberste in der Liste). Die Datei sollte den Namen \texttt{kotlin-compiler-<version>.zip} haben.
%     \item Entpacke die Datei in einen Ordner deiner Wahl.
%     \item Gehe nun in den bin-Ordner der entpackten Datei und öffne dort ein Terminal. (Shift + Rechtsklick $\rightarrow$ \enquote{Eingabeaufforderung hier öffnen} oder \enquote{PowerShell-Fenster hier öffnen}).
%     \item Überprüfe die Installation (siehe Abschnitt \nameref{sec:check})
% \end{itemize}
% \begin{hinweis}
%     Diese Installation funktioniert nur, solange sich deine Komandozeile im bin-Ordner befindet. Wenn du die Komandozeile schließt, musst du sie erneut öffnen und in den bin-Ordner wechseln.
% \end{hinweis}
\section*{Mac OS}
% Kaufe jetzt das Kotlin Starter Kit für nur 99,99€ im App Store und erhalte eine kostenlose Kotlin-Tasse im Wert von 9,99€ dazu! Nur solange der Vorrat reicht! (Nein, Spaß, aber wir haben leider keine Macs zum Testen.)
\subsection*{Automatische Installation durch Homebrew}
\begin{itemize}
    \item Gebe in der Komandozeile den folgenden Befehl ein und drücke Enter\footnote{Befehle generiert mit \url{https://formulae.brew.sh/formula/kotlin} und \url{https://formulae.brew.sh/formula/ki}}:
        %\begin{noindent}
\begin{commandshell}
@\shellprefix{}@brew install kotlin
@\shellprefix{}@brew install ki
\end{commandshell}
    %\end{noindent}
    \item Warte, bis die Installation abgeschlossen ist
    \item Überprüfe die Installation (siehe Abschnitt \nameref{sec:check})
\end{itemize}

\section*{Linux}
\subsection*{JVM und Kotlin}
Auf dem meisten Distros heißt das zu installierende Paket einfach {\ttfamily kotlin} und hat automatisch die korrekte java-Version als Abhängigkeit.
\begin{commandshell}[][minted language=text]
    @\shellprefix{}@pacman -S kotlin @\PYG{c+c1}{# Arch Linux}@
\end{commandshell}

\begin{commandshell}[][minted language=text]
    @\shellprefix{}@apt install kotlin @\PYG{c+c1}{# Debian, Ubuntu, Mint, ...}@
\end{commandshell}

\subsection*{ki}
Für Arch-Linux gibt es ein AUR-Paket: \url{https://aur.archlinux.org/packages/ki/}
Für alle anderen haben wir \href{https://raw.githubusercontent.com/d120/vorkurs/91e562678d871e52162ac98ee7175842ba628a96/misc/scripts/install-ki-locally.sh}{ein script} bereitgestellt:
\begin{commandshell}
    wget -O - https://raw.githubusercontent.com\
    /d120/vorkurs/91e562678d871e52162ac98ee7175842ba628a96\
    /misc/scripts/install-ki-locally.sh | bash
\end{commandshell}

\section*{Überprüfung der Installation}\label{sec:check}
Um zu testen ob alles geklappt hat, öffne eine Kommandozeile und gebe den folgenden Befehl ein:
\begin{commandshell}
    @\shellprefix{}@kotlinc -version
\end{commandshell}

Wenn alles geklappt hat, sollte die Ausgabe in etwa so aussehen (die Versionsnummern können abweichen):
\begin{commandshell}[][]
    @\shellprefix{}@kotlinc -version
    info: kotlinc-jvm 1.9.10 (JRE 17.0.8.1+1)
\end{commandshell}

Ob \texttt{ki} funktioniert, kannst du mit dem folgenden Befehl testen:
\begin{commandshell}
    @\shellprefix{}@ki
\end{commandshell}
Wenn alles geklappt hat, sollte die Ausgabe in etwa so aussehen (die Versionsnummern können abweichen):
\begin{commandshell}[][minted language=text]
    @\shellprefix@ki
    ki-shell 0.5.2/1.7.0
    type :h for help
    [0] @\shellcursor@
\end{commandshell}

\end{document}
